<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>AgpWriter.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Jillion</a> &gt; <a href="index.source.html" class="el_package">org.jcvi.jillion.experimental.assembly.agp</a> &gt; <span class="el_source">AgpWriter.java</span></div><h1>AgpWriter.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * Jillion development code
 * 
 * This code may be freely distributed and modified under the
 * terms of the GNU Lesser General Public License.  This should
 * be distributed with the code.  If you do not have a copy,
 *  see:
 * 
 *          http://www.gnu.org/copyleft/lesser.html
 * 
 * 
 * Copyright for this code is held jointly by the individual authors.  These should be listed in the @author doc comments.
 * 
 * Information about Jillion can be found on its homepage
 * 
 *         http://jillion.sourceforge.net
 * 
 * Contributors:
 *     Danny Katzel - initial API and implementation
 ******************************************************************************/
package org.jcvi.jillion.experimental.assembly.agp;

import java.io.IOException;
import java.io.OutputStream;

import org.jcvi.jillion.assembly.PlacedContig;
import org.jcvi.jillion.assembly.Scaffold;
import org.jcvi.jillion.assembly.util.CoverageMap;
import org.jcvi.jillion.assembly.util.CoverageRegion;
import org.jcvi.jillion.core.Range;
import org.jcvi.jillion.core.Range.CoordinateSystem;
import org.jcvi.jillion.core.io.IOUtil;

public final class AgpWriter {

<span class="nc" id="L36">	private AgpWriter(){</span>
		//no-op
<span class="nc" id="L38">	}</span>
	public static void writeScaffold(Scaffold scaffold, OutputStream out) throws IOException{
<span class="nc" id="L40">		CoverageMap&lt;PlacedContig&gt; coverageMap =scaffold.getContigCoverageMap();</span>
<span class="nc" id="L41">		String scaffoldId = scaffold.getId();</span>
<span class="nc" id="L42">		int partNumber =1;</span>
<span class="nc bnc" id="L43" title="All 2 branches missed.">		for(CoverageRegion&lt;PlacedContig&gt; region : coverageMap){</span>
<span class="nc bnc" id="L44" title="All 2 branches missed.">			if(region.getCoverageDepth()==0){</span>
<span class="nc" id="L45">				writeNs(scaffoldId, partNumber, region.asRange(), out);</span>
<span class="nc" id="L46">				partNumber++;</span>
			}else{
<span class="nc bnc" id="L48" title="All 2 branches missed.">				for(PlacedContig contig : region){</span>
<span class="nc" id="L49">					writeContig(scaffoldId, partNumber, contig, out);	</span>
<span class="nc" id="L50">					partNumber++;</span>
<span class="nc" id="L51">				}</span>
			}
<span class="nc" id="L53">		}</span>
<span class="nc" id="L54">	}</span>

	private static void writeContig(String scaffoldId, int partNumber,
			PlacedContig contig, OutputStream out) throws IOException {
<span class="nc" id="L58">		Range range =contig.asRange();</span>
		// chrY	1	3043	1	W	AADB02037551.1	1	3043	+
<span class="nc" id="L60">		String line = String.format(&quot;%s\t%d\t%d\t%d\tW\t%s\t1\t%d\t+%n&quot;,</span>
				scaffoldId,
<span class="nc" id="L62">				range.getBegin(CoordinateSystem.RESIDUE_BASED),</span>
<span class="nc" id="L63">				range.getEnd(CoordinateSystem.RESIDUE_BASED),</span>
<span class="nc" id="L64">				partNumber,</span>
<span class="nc" id="L65">				contig.getContigId(),</span>
<span class="nc" id="L66">				range.getLength()</span>
				);
<span class="nc" id="L68">		out.write(line.getBytes(IOUtil.UTF_8));</span>
<span class="nc" id="L69">	}</span>

	private static void writeNs(String scaffoldId,int partNumber, Range range,
			OutputStream out) throws IOException {
		//chrY	3044	53043	2	N	50000	contig	no	
<span class="nc" id="L74">		String line = String.format(&quot;%s\t%d\t%d\t%d\tN\t%d\tcontig\tno\tna%n&quot;,</span>
				scaffoldId,
<span class="nc" id="L76">				range.getBegin(CoordinateSystem.RESIDUE_BASED),</span>
<span class="nc" id="L77">				range.getEnd(CoordinateSystem.RESIDUE_BASED),</span>
<span class="nc" id="L78">				partNumber,</span>
<span class="nc" id="L79">				range.getLength()</span>
				);
<span class="nc" id="L81">		out.write(line.getBytes(IOUtil.UTF_8));</span>
		
<span class="nc" id="L83">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>