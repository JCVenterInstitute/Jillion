<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>SaltCorrectionStrategy.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Jillion</a> &gt; <a href="index.source.html" class="el_package">org.jcvi.jillion.experimental.primer</a> &gt; <span class="el_source">SaltCorrectionStrategy.java</span></div><h1>SaltCorrectionStrategy.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * Jillion development code
 * 
 * This code may be freely distributed and modified under the
 * terms of the GNU Lesser General Public License.  This should
 * be distributed with the code.  If you do not have a copy,
 *  see:
 * 
 *          http://www.gnu.org/copyleft/lesser.html
 * 
 * 
 * Copyright for this code is held jointly by the individual authors.  These should be listed in the @author doc comments.
 * 
 * Information about Jillion can be found on its homepage
 * 
 *         http://jillion.sourceforge.net
 * 
 * Contributors:
 *     Danny Katzel - initial API and implementation
 ******************************************************************************/
package org.jcvi.jillion.experimental.primer;

<span class="pc" id="L23">public enum SaltCorrectionStrategy {</span>
	/**
	 * The used salt correction
	 * used most often in programs
	 * like primer3.
	 * The correction equation is 
	 * &lt;pre&gt;16.6 * log10(concentration in nM) + initialTm&lt;/pre&gt;
	 * The implementation will convert the input mM into nM.
	 * This equation
	 * was derived by
	 * 
	 * C C Schildkraut Biopolymers 3(2):195-208 (1965), PMID 5889540.
	 */
<span class="fc" id="L36">	SCHILDKRAUT_LIFSON(16.6D),</span>
	/**
	 * The used salt correction
	 * listed in the santaLucia96 paper.
	 * The correction equation is 
	 * &lt;pre&gt;12.5 * log10(concentration in nM) + initialTm&lt;/pre&gt;
	 * The implementation will convert the input mM into nM.
	 * This equation
	 * was derived by
	 * SantaLucia96
	 * @see &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/8639506&quot;&gt;
	 SantaLucia J Jr, Allawi HT, Seneviratne PA.
	 Improved nearest-neighbor parameters for predicting DNA duplex stability.
	Biochemistry. 1996 Mar 19;35(11):3555-62; PMID 8639506 &lt;/a&gt;
	 */
<span class="fc" id="L51">	SANTALUCIA_1996(12.5D),</span>
	/**
	 * No Salt Correction,
	 * {@link #adjustTemperature(double, double)}
	 * returns the initial uncorrected temperature.
	 */
<span class="fc" id="L57">	NONE(0D){</span>
		/**
		 * @return initialTm always.
		 */
		@Override
		public double adjustTemperature(double initialTm, double mM) {
<span class="nc" id="L63">			return initialTm;</span>
		}
		
	}
	;
	
	private static final double MICRO_MOLAR_CONVERSION = 1000D;
	private final double adjustmentConstant;
	
<span class="fc" id="L72">	private SaltCorrectionStrategy(double adjustmentConstant){</span>
<span class="fc" id="L73">		this.adjustmentConstant = adjustmentConstant;</span>
<span class="fc" id="L74">	}</span>
	/**
	 * Adjust the given melting temperature
	 * for the given salt concentration in mM.
	 * @param initialTm the initial temperature
	 * in degrees celsius;
	 * @param mM salt concentration in mM;
	 * can not be negative.
	 * @return a new temperature in degrees
	 * celsius taking salt concentration into account.
	 */
	public double adjustTemperature(double initialTm, double mM){
<span class="pc bpc" id="L86" title="1 of 2 branches missed.">		if(mM&lt;0){</span>
<span class="nc" id="L87">			throw new IllegalArgumentException(&quot;concentration can not be negative&quot;);</span>
		}
<span class="fc" id="L89">		return adjustmentConstant * Math.log10(mM/MICRO_MOLAR_CONVERSION) + initialTm;</span>
	}
	
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>