<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>HspBuilder.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Jillion</a> &gt; <a href="index.source.html" class="el_package">org.jcvi.jillion.experimental.align.blast</a> &gt; <span class="el_source">HspBuilder.java</span></div><h1>HspBuilder.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * Jillion development code
 * 
 * This code may be freely distributed and modified under the
 * terms of the GNU Lesser General Public License.  This should
 * be distributed with the code.  If you do not have a copy,
 *  see:
 * 
 *          http://www.gnu.org/copyleft/lesser.html
 * 
 * 
 * Copyright for this code is held jointly by the individual authors.  These should be listed in the @author doc comments.
 * 
 * Information about Jillion can be found on its homepage
 * 
 *         http://jillion.sourceforge.net
 * 
 * Contributors:
 *     Danny Katzel - initial API and implementation
 ******************************************************************************/
package org.jcvi.jillion.experimental.align.blast;

import java.math.BigDecimal;

import org.jcvi.jillion.core.DirectedRange;
import org.jcvi.jillion.core.residue.Residue;
import org.jcvi.jillion.core.residue.ResidueSequence;
import org.jcvi.jillion.core.residue.ResidueSequenceBuilder;
import org.jcvi.jillion.core.residue.aa.AminoAcid;
import org.jcvi.jillion.core.residue.aa.ProteinSequence;
import org.jcvi.jillion.core.residue.aa.ProteinSequenceBuilder;
import org.jcvi.jillion.core.residue.nt.Nucleotide;
import org.jcvi.jillion.core.residue.nt.NucleotideSequence;
import org.jcvi.jillion.core.residue.nt.NucleotideSequenceBuilder;

/**
 * @author dkatzel
 *
 *
 */
public final class HspBuilder&lt;R extends Residue, S extends ResidueSequence&lt;R, S, B&gt;, B extends ResidueSequenceBuilder&lt;R, S&gt;&gt; implements org.jcvi.jillion.core.util.Builder&lt;Hsp&lt;R,S,B&gt;&gt;{

    private static final double ONE_HUNDRED = 100.0D;


        private String queryId;
        private String subjectId;
        private String subjectDef;
        
        private Double percentIdentity;
        private BigDecimal eValue, bitScore;
        private DirectedRange queryRange, subjectRange;
        private Integer numGapsOpenings ,numMismatches, numIdentical, numPositive,
        	alignmentLength, queryLength, subjectLength;
        private S queryAlignment, subjectAlignment;
        private Float hspScore;
        private Integer hitFrame;
        
        
        /**
         * Create a new {@link HspBuilder} for BLASTN (Nucleotide query to Nucleotide subject) results.
         * @return a new {@link HspBuilder} will never be null.
         */
        public static HspBuilder&lt;Nucleotide,NucleotideSequence,NucleotideSequenceBuilder&gt; forBlastN(){
<span class="fc" id="L65">        	return new HspBuilder&lt;Nucleotide,NucleotideSequence,NucleotideSequenceBuilder&gt;();</span>
        }
        /**
         * Create a new {@link HspBuilder} for BLASTP (Protein query to Protein subject) results.
         * @return a new {@link HspBuilder} will never be null.
         */
        public static HspBuilder&lt;AminoAcid,ProteinSequence,ProteinSequenceBuilder&gt; forBlastP(){
<span class="nc" id="L72">        	return new HspBuilder&lt;AminoAcid,ProteinSequence,ProteinSequenceBuilder&gt;();</span>
        }
        /**
         * Create a new {@link HspBuilder} for BLASTX (Nucleotide (translated) query to Protein subject) results.
         * @return a new {@link HspBuilder} will never be null.
         */
        public static HspBuilder&lt;AminoAcid,ProteinSequence,ProteinSequenceBuilder&gt; forBlastX(){
<span class="nc" id="L79">        	return new HspBuilder&lt;AminoAcid,ProteinSequence,ProteinSequenceBuilder&gt;();</span>
        }
        /**
         * Create a new {@link HspBuilder} for TBLASTX (Nucleotide (translated) query to Nucleotide (translated) subject) results.
         * @return a new {@link HspBuilder} will never be null.
         */
        public static HspBuilder&lt;AminoAcid,ProteinSequence,ProteinSequenceBuilder&gt; forTBlastX(){
<span class="nc" id="L86">        	return new HspBuilder&lt;AminoAcid,ProteinSequence,ProteinSequenceBuilder&gt;();</span>
        }
        /**
         * Create a new {@link HspBuilder} for TBLASTN (Protein query to Nucleotide (translated) subject) results.
         * @return a new {@link HspBuilder} will never be null.
         */
        public static HspBuilder&lt;AminoAcid,ProteinSequence,ProteinSequenceBuilder&gt; forTBlastN(){
<span class="nc" id="L93">        	return new HspBuilder&lt;AminoAcid,ProteinSequence,ProteinSequenceBuilder&gt;();</span>
        }
        /**
         * Create a new {@link HspBuilder} instance for the given type
         * by name (&quot;blastn&quot;, &quot;blastp&quot; etc).
         * @param type the name of the type, case-insensitive; can not be null.
         * @return  a new {@link HspBuilder} will never be null.
         * @throws NullPointerException if type is null.
         * @throws IllegalArgumentException if type is not
         * equal-ignoring-case with &quot;blastn&quot;, &quot;blastp&quot;, &quot;blastx&quot;, &quot;tblastn&quot;,  or &quot;tblastp&quot;.
         */
        public static HspBuilder&lt;?,?,?&gt; forType(String type){
<span class="nc bnc" id="L105" title="All 2 branches missed.">        	if(type==null){</span>
<span class="nc" id="L106">        		throw new NullPointerException(&quot;type can not be null&quot;);</span>
        	}
<span class="nc bnc" id="L108" title="All 2 branches missed.">        	if(&quot;blastn&quot;.equalsIgnoreCase(type)){</span>
<span class="nc" id="L109">        		return forBlastN();</span>
        	}
<span class="nc bnc" id="L111" title="All 2 branches missed.">        	if(&quot;blastp&quot;.equalsIgnoreCase(type)){</span>
<span class="nc" id="L112">        		return forBlastP();</span>
        	}
<span class="nc bnc" id="L114" title="All 2 branches missed.">        	if(&quot;blastx&quot;.equalsIgnoreCase(type)){</span>
<span class="nc" id="L115">        		return forBlastX();</span>
        	}
<span class="nc bnc" id="L117" title="All 2 branches missed.">        	if(&quot;tblastx&quot;.equalsIgnoreCase(type)){</span>
<span class="nc" id="L118">        		return forTBlastX();</span>
        	}
<span class="nc bnc" id="L120" title="All 2 branches missed.">        	if(&quot;tblastn&quot;.equalsIgnoreCase(type)){</span>
<span class="nc" id="L121">        		return forTBlastN();</span>
        	}
<span class="nc" id="L123">        	throw new IllegalArgumentException(&quot;unknown type :&quot; + type);</span>
        }
    	
        public static &lt;R extends Residue, S extends ResidueSequence&lt;R, S, B&gt;, B extends ResidueSequenceBuilder&lt;R, S&gt;&gt; HspBuilder&lt;R,S, B&gt; copy(Hsp&lt;R,S, B&gt; hsp){
<span class="fc" id="L127">            return new HspBuilder&lt;R,S,B&gt;(hsp);</span>
        }
        
        /**
         * Create a new instance of {@link HspBuilder}
         * that is an exact copy of this instance.
         * Any future modifications to either builder
         * will not affect the other. 
         * @return  a new {@link HspBuilder} will never be null.
         */
        public  HspBuilder&lt;R,S,B&gt; copy(){
<span class="nc" id="L138">            return new HspBuilder&lt;R,S,B&gt;(this);</span>
        }
        
        
        
<span class="nc" id="L143">        private HspBuilder(HspBuilder&lt;R,S,B&gt; copy){</span>
<span class="nc" id="L144">        	this.bitScore =copy.bitScore;</span>
<span class="nc" id="L145">        	this.eValue = copy.eValue;</span>
<span class="nc" id="L146">        	this.numGapsOpenings = copy.numGapsOpenings;</span>
<span class="nc" id="L147">        	this.numMismatches = copy.numMismatches;</span>
<span class="nc" id="L148">            this.percentIdentity = copy.percentIdentity;</span>
<span class="nc" id="L149">            this.queryRange = copy.queryRange;</span>
<span class="nc" id="L150">            this.subjectRange = copy.subjectRange;</span>
<span class="nc" id="L151">            this.queryAlignment =copy.queryAlignment;</span>
<span class="nc" id="L152">            this.queryId = copy.queryId;</span>
<span class="nc" id="L153">            this.subjectAlignment = copy.subjectAlignment;</span>
<span class="nc" id="L154">            this.subjectId = copy.subjectId;</span>
<span class="nc" id="L155">            this.alignmentLength = copy.alignmentLength;</span>
            
<span class="nc" id="L157">        }</span>
<span class="fc" id="L158">        private HspBuilder(Hsp&lt;R,S,B&gt; copy) {</span>
           
<span class="fc" id="L160">            bitScore(copy.getBitScore())</span>
<span class="fc" id="L161">            .eValue(copy.getEvalue())</span>
<span class="fc" id="L162">            .numGapOpenings(copy.getNumberOfGapOpenings())</span>
<span class="fc" id="L163">            .numMismatches(copy.getNumberOfMismatches())</span>
<span class="fc" id="L164">            .percentIdentity(copy.getPercentIdentity())</span>
<span class="fc" id="L165">            .queryRange(copy.getQueryRange())</span>
<span class="fc" id="L166">            .query(copy.getQueryId())</span>
<span class="fc" id="L167">            .subject(copy.getSubjectId())</span>
<span class="fc" id="L168">            .subjectRange(copy.getSubjectRange())</span>
<span class="fc" id="L169">            .alignmentLength(copy.getAlignmentLength())</span>
            ;
            
<span class="pc bpc" id="L172" title="1 of 2 branches missed.">            if(copy.hasAlignments()){</span>
<span class="nc" id="L173">            	gappedAlignments(copy.getGappedQueryAlignment(), copy.getGappedSubjectAlignment());</span>
            }
<span class="fc" id="L175">        }</span>
<span class="fc" id="L176">        private HspBuilder(){</span>
        	
<span class="fc" id="L178">        }</span>
<span class="nc" id="L179">        private HspBuilder(String queryId) {</span>
<span class="nc" id="L180">            query(queryId);</span>
<span class="nc" id="L181">        }</span>
        public HspBuilder&lt;R,S,B&gt; gappedAlignments(S queryAlignment, S subjectAlignment) {
<span class="pc bpc" id="L183" title="6 of 8 branches missed.">            if((queryAlignment ==null &amp;&amp; subjectAlignment !=null) </span>
            		|| (subjectAlignment ==null &amp;&amp; queryAlignment !=null)){
<span class="nc" id="L185">                throw new NullPointerException(&quot;gapped alignments must be either both null or neither null&quot;);</span>
            }
<span class="fc" id="L187">            this.queryAlignment = queryAlignment;</span>
<span class="fc" id="L188">            this.subjectAlignment = subjectAlignment;</span>
<span class="fc" id="L189">            return this;</span>
        }
        public HspBuilder&lt;R,S,B&gt;  query(String queryId) {
<span class="fc bfc" id="L192" title="All 2 branches covered.">            if(queryId ==null){</span>
<span class="fc" id="L193">                throw new NullPointerException(&quot;query id can not be null&quot;);</span>
            }
<span class="fc" id="L195">            String trimmed = queryId.trim();</span>
<span class="fc bfc" id="L196" title="All 2 branches covered.">            if(trimmed.isEmpty()){</span>
<span class="fc" id="L197">                throw new IllegalArgumentException(&quot;query id can not be empty&quot;);</span>
            }
<span class="fc" id="L199">            this.queryId = trimmed;</span>
<span class="fc" id="L200">            return this;</span>
        }
        public HspBuilder&lt;R,S,B&gt;  subjectDef(String subjectDef){           
<span class="fc" id="L203">            this.subjectDef = subjectDef;</span>
<span class="fc" id="L204">            return this;</span>
        }
        public HspBuilder&lt;R,S,B&gt;  subject(String subjectId){
<span class="fc bfc" id="L207" title="All 2 branches covered.">            if(subjectId ==null){</span>
<span class="fc" id="L208">                throw new NullPointerException(&quot;subject id can not be null&quot;);</span>
            }
<span class="fc" id="L210">            String trimmed = subjectId.trim();</span>
<span class="fc bfc" id="L211" title="All 2 branches covered.">            if(trimmed.isEmpty()){</span>
<span class="fc" id="L212">                throw new IllegalArgumentException(&quot;query id can not be empty&quot;);</span>
            }
<span class="fc" id="L214">            this.subjectId = trimmed;</span>
<span class="fc" id="L215">            return this;</span>
        }

        public HspBuilder&lt;R,S,B&gt;  percentIdentity(double percentIdentity){            
<span class="fc bfc" id="L219" title="All 2 branches covered.">            if(percentIdentity &lt;0){</span>
<span class="fc" id="L220">                throw new IllegalArgumentException(&quot;percentIdentity score must be positive: &quot; + percentIdentity);</span>
            }
<span class="fc bfc" id="L222" title="All 2 branches covered.">            if(percentIdentity &gt;ONE_HUNDRED){</span>
<span class="fc" id="L223">                throw new IllegalArgumentException(&quot;percentIdentity score must be &lt;= 100: &quot; + percentIdentity);</span>
            }
<span class="fc" id="L225">            this.percentIdentity = percentIdentity;</span>
<span class="fc" id="L226">            return this;</span>
        }
        public HspBuilder&lt;R,S,B&gt;  bitScore(BigDecimal bitScore){  
<span class="fc bfc" id="L229" title="All 2 branches covered.">            if(bitScore ==null){</span>
<span class="fc" id="L230">                throw new NullPointerException(&quot;bit score can not be null&quot;);</span>
            }
<span class="fc bfc" id="L232" title="All 2 branches covered.">            if(bitScore.compareTo(BigDecimal.ZERO) &lt;0){</span>
<span class="fc" id="L233">                throw new IllegalArgumentException(&quot;bit score must be positive: &quot; + bitScore);</span>
            }
<span class="fc" id="L235">            this.bitScore = bitScore;</span>
<span class="fc" id="L236">            return this;</span>
        }
        
        public HspBuilder&lt;R,S,B&gt;  queryRange(DirectedRange queryRange){
<span class="fc bfc" id="L240" title="All 2 branches covered.">            if(queryRange ==null){</span>
<span class="fc" id="L241">                throw new NullPointerException(&quot;queryRange can not be null&quot;);</span>
            }
<span class="fc" id="L243">            this.queryRange = queryRange;</span>
<span class="fc" id="L244">            return this;</span>
        }

        public HspBuilder&lt;R,S,B&gt;  subjectRange(DirectedRange subjectRange){
<span class="fc bfc" id="L248" title="All 2 branches covered.">            if(subjectRange ==null){</span>
<span class="fc" id="L249">                throw new NullPointerException(&quot;subjectRange can not be null&quot;);</span>
            }
<span class="fc" id="L251">            this.subjectRange = subjectRange;</span>
<span class="fc" id="L252">            return this;</span>
        }
        public HspBuilder&lt;R,S,B&gt;  eValue(BigDecimal eValue){
<span class="fc bfc" id="L255" title="All 2 branches covered.">            if(eValue ==null){</span>
<span class="fc" id="L256">                throw new NullPointerException(&quot;e-value can not be null&quot;);</span>
            }
<span class="fc bfc" id="L258" title="All 2 branches covered.">            if(eValue.compareTo(BigDecimal.ZERO)&lt;0){</span>
<span class="fc" id="L259">                throw new IllegalArgumentException(&quot;e-value score must be positive: &quot; + eValue);</span>
            }
<span class="fc" id="L261">            this.eValue = eValue;</span>
<span class="fc" id="L262">            return this;</span>
        }
        
        public HspBuilder&lt;R,S,B&gt;  numGapOpenings(int numberOfGapOpenings){
<span class="fc bfc" id="L266" title="All 2 branches covered.">            if(numberOfGapOpenings&lt;0){</span>
<span class="fc" id="L267">                throw new IllegalArgumentException(&quot;number of gap openings can not be negative : &quot; + numberOfGapOpenings);</span>
            }
<span class="fc" id="L269">            this.numGapsOpenings = numberOfGapOpenings;</span>
<span class="fc" id="L270">            return this;</span>
        }
        public HspBuilder&lt;R,S,B&gt;  numMismatches(int numberOfMismatches){
<span class="fc bfc" id="L273" title="All 2 branches covered.">            if(numberOfMismatches&lt;0){</span>
<span class="fc" id="L274">                throw new IllegalArgumentException(&quot;number of mismatches can not be negative : &quot; + numberOfMismatches);</span>
            }
<span class="fc" id="L276">            this.numMismatches = numberOfMismatches;</span>
<span class="fc" id="L277">            return this;</span>
        }
        public HspBuilder&lt;R,S,B&gt;  numIdenticalMatches(int numIdentical){
<span class="pc bpc" id="L280" title="1 of 2 branches missed.">            if(numIdentical&lt;0){</span>
<span class="nc" id="L281">                throw new IllegalArgumentException(&quot;number of identical can not be negative : &quot; + numIdentical);</span>
            }
<span class="fc" id="L283">            this.numIdentical = numIdentical;</span>
<span class="fc" id="L284">            return this;</span>
        }
        public HspBuilder&lt;R,S,B&gt;  numPositiveMatches(int numPositive){
<span class="pc bpc" id="L287" title="1 of 2 branches missed.">            if(numPositive&lt;0){</span>
<span class="nc" id="L288">                throw new IllegalArgumentException(&quot;number of positive matches can not be negative : &quot; + numIdentical);</span>
            }
<span class="fc" id="L290">            this.numPositive = numPositive;</span>
<span class="fc" id="L291">            return this;</span>
        }
        public HspBuilder&lt;R,S,B&gt;  alignmentLength(int alignmentLength){
<span class="fc bfc" id="L294" title="All 2 branches covered.">            if(alignmentLength&lt;0){</span>
<span class="fc" id="L295">                throw new IllegalArgumentException(&quot;alignment length can not be negative : &quot; + alignmentLength);</span>
            }
<span class="fc" id="L297">            this.alignmentLength = alignmentLength;</span>
<span class="fc" id="L298">            return this;</span>
        }
        
        public HspBuilder&lt;R,S,B&gt; hitFrame(Integer frame) {
<span class="fc" id="L302">    		this.hitFrame = frame;</span>
<span class="fc" id="L303">    		return this;</span>
    	}
        
        
        public HspBuilder&lt;R,S,B&gt;  queryLength(int queryLength){
<span class="pc bpc" id="L308" title="1 of 2 branches missed.">            if(queryLength&lt;0){</span>
<span class="nc" id="L309">                throw new IllegalArgumentException(&quot;query length can not be negative : &quot; + queryLength);</span>
            }
<span class="fc" id="L311">            this.queryLength = queryLength;</span>
<span class="fc" id="L312">            return this;</span>
        }
        public HspBuilder&lt;R,S,B&gt;  subjectLength(int subjectLength){
<span class="pc bpc" id="L315" title="1 of 2 branches missed.">            if(subjectLength&lt;0){</span>
<span class="nc" id="L316">                throw new IllegalArgumentException(&quot;subject length can not be negative : &quot; + subjectLength);</span>
            }
<span class="fc" id="L318">            this.subjectLength = subjectLength;</span>
<span class="fc" id="L319">            return this;</span>
        }
        public HspBuilder&lt;R,S,B&gt;  hspScore(float hspScore){
<span class="pc bpc" id="L322" title="1 of 2 branches missed.">            if(hspScore &lt;0){</span>
<span class="nc" id="L323">                throw new IllegalArgumentException(&quot;hsp score can not be negative : &quot; + hspScore);</span>
            }
<span class="fc" id="L325">            this.hspScore = hspScore;</span>
<span class="fc" id="L326">            return this;</span>
        }
        /**
        * {@inheritDoc}
        */
        @Override
        public Hsp&lt;R,S, B&gt;  build() {
<span class="fc" id="L333">            verifyAllValuesSet();</span>
<span class="fc" id="L334">            sanityCheckValues();</span>
<span class="fc" id="L335">            return new HspImpl&lt;&gt;(this);</span>
        }

        private void sanityCheckValues() {
<span class="pc bpc" id="L339" title="2 of 6 branches missed.">        	if(numPositive !=null &amp;&amp; numIdentical != null &amp;&amp; numPositive &lt; numIdentical){</span>
<span class="nc" id="L340">        		throw new IllegalStateException(&quot;number of matches must be &gt;= number of identical matches&quot;);        		</span>
        	}
<span class="fc" id="L342">		}</span>
		/**
         * 
         */
        private void verifyAllValuesSet() {
<span class="pc bpc" id="L347" title="1 of 2 branches missed.">            if(subjectId == null){</span>
<span class="nc" id="L348">                throw new IllegalStateException(&quot;must set subject id&quot;);</span>
            }
<span class="pc bpc" id="L350" title="1 of 2 branches missed.">            if(percentIdentity==null){</span>
<span class="nc" id="L351">                throw new IllegalStateException(&quot;must set percent identity&quot;);</span>
            }
<span class="pc bpc" id="L353" title="1 of 2 branches missed.">            if(bitScore==null){</span>
<span class="nc" id="L354">                throw new IllegalStateException(&quot;must set bit score&quot;);</span>
            }
<span class="pc bpc" id="L356" title="1 of 2 branches missed.">            if(eValue==null){</span>
<span class="nc" id="L357">                throw new IllegalStateException(&quot;must set e-value&quot;);</span>
            }
<span class="pc bpc" id="L359" title="1 of 2 branches missed.">            if(queryRange==null){</span>
<span class="nc" id="L360">                throw new IllegalStateException(&quot;must set query range&quot;);</span>
            }
<span class="pc bpc" id="L362" title="1 of 2 branches missed.">            if(subjectRange==null){</span>
<span class="nc" id="L363">                throw new IllegalStateException(&quot;must set subject range&quot;);</span>
            }
<span class="pc bpc" id="L365" title="1 of 2 branches missed.">            if(numGapsOpenings==null){</span>
<span class="nc" id="L366">                throw new IllegalStateException(&quot;must set number of gap openings&quot;);</span>
            }
<span class="pc bpc" id="L368" title="1 of 2 branches missed.">            if(numMismatches==null){</span>
<span class="nc" id="L369">                throw new IllegalStateException(&quot;must set number of mismatches&quot;);</span>
            }
<span class="pc bpc" id="L371" title="1 of 2 branches missed.">            if(alignmentLength==null){</span>
<span class="nc" id="L372">                throw new IllegalStateException(&quot;must set alignment length&quot;);</span>
            }
<span class="fc" id="L374">        }</span>
        
    

    private static final class HspImpl&lt;R extends Residue, S extends ResidueSequence&lt;R, S, B&gt;, B extends ResidueSequenceBuilder&lt;R, S&gt;&gt; implements Hsp&lt;R,S, B&gt;{
        
    private final String queryId,subjectId, subjectDef;
    private final double percentIdentity;
    private final BigDecimal eValue, bitScore;
    private final DirectedRange queryRange, subjectRange;
    private final int numGapsOpenings,numMismatches ;
    private final int alignmentLength;
    private final S queryAlignment;
    private final S subjectAlignment;
    private final Integer queryLength, subjectLength,numIdenticalMatches,numPositiveMatches;
    private final Float hspScore;
    private final Integer hitFrame;
    
<span class="fc" id="L392">    private HspImpl(HspBuilder&lt;R,S, B&gt; builder) {</span>
<span class="fc" id="L393">        this.queryId = builder.queryId;</span>
<span class="fc" id="L394">        this.subjectId = builder.subjectId;</span>
<span class="fc" id="L395">        this.percentIdentity = builder.percentIdentity;</span>
<span class="fc" id="L396">        this.bitScore = builder.bitScore;</span>
<span class="fc" id="L397">        this.eValue = builder.eValue;</span>
<span class="fc" id="L398">        this.queryRange = builder.queryRange;</span>
<span class="fc" id="L399">        this.subjectRange = builder.subjectRange;</span>
<span class="fc" id="L400">        this.numGapsOpenings = builder.numGapsOpenings;</span>
<span class="fc" id="L401">        this.numMismatches = builder.numMismatches;</span>
<span class="fc" id="L402">        this.alignmentLength = builder.alignmentLength;</span>
<span class="fc" id="L403">        this.queryAlignment = builder.queryAlignment;</span>
<span class="fc" id="L404">        this.subjectAlignment = builder.subjectAlignment;</span>
<span class="fc" id="L405">        this.queryLength = builder.queryLength;</span>
<span class="fc" id="L406">        this.hspScore = builder.hspScore;</span>
<span class="fc" id="L407">        this.subjectDef = builder.subjectDef;</span>
<span class="fc" id="L408">        this.subjectLength = builder.subjectLength;</span>
<span class="fc" id="L409">        this.numIdenticalMatches = builder.numIdentical;</span>
<span class="fc" id="L410">        this.numPositiveMatches = builder.numPositive;</span>
<span class="fc" id="L411">        this.hitFrame = builder.hitFrame;</span>
<span class="fc" id="L412">    }</span>


   @Override
	public Integer getHitFrame() {
<span class="nc" id="L417">		return hitFrame;</span>
	}


@Override
	public Integer getNumberOfIdentitcalMatches() {
<span class="nc" id="L423">		return numIdenticalMatches;</span>
	}


	@Override
	public Integer getNumberOfPositiveMatches() {
<span class="nc" id="L429">		return numPositiveMatches;</span>
	}


@Override
	public Integer getSubjectLength() {
<span class="nc" id="L435">		return subjectLength;</span>
	}


@Override
	public String getSubjectDefinition() {
<span class="fc" id="L441">		return subjectDef;</span>
	}


@Override
	public Float getHspScore() {
<span class="fc" id="L447">		return hspScore;</span>
	}


@Override
	public Integer getQueryLength() {
<span class="nc" id="L453">		return queryLength;</span>
	}


   /**
    * {@inheritDoc}
    */
    @Override
    public boolean hasAlignments() {
<span class="pc bpc" id="L462" title="1 of 2 branches missed.">        return queryAlignment!=null;</span>
    }


    /**
    * {@inheritDoc}
    */
    @Override
    public S getGappedQueryAlignment() {
<span class="nc" id="L471">        return queryAlignment;</span>
    }


    /**
    * {@inheritDoc}
    */
    @Override
    public S getGappedSubjectAlignment() {
<span class="nc" id="L480">        return subjectAlignment;</span>
    }


        /**
        * {@inheritDoc}
        */
        @Override
        public String toString() {
<span class="nc" id="L489">            return &quot;HspImpl [queryId=&quot; + queryId + &quot;, subjectId=&quot;</span>
                    + subjectId + &quot;, percentIdentity=&quot; + percentIdentity
                    + &quot;, eValue=&quot; + eValue + &quot;, bitScore=&quot; + bitScore
                    + &quot;, queryRange=&quot; + queryRange + &quot;, subjectRange=&quot;
                    + subjectRange + &quot;, numGapsOpenings=&quot; + numGapsOpenings
                    + &quot;, numMismatches=&quot; + numMismatches + &quot;, alignmentLength=&quot;
                    + alignmentLength + &quot;, queryAlignment=&quot; + queryAlignment
                    + &quot;, subjectAlignment=&quot; + subjectAlignment + &quot;]&quot;;
        }

        /**
        * {@inheritDoc}
        */
        @Override
        public String getQueryId() {
<span class="fc" id="L504">            return queryId;</span>
        }
    
        /**
        * {@inheritDoc}
        */
        @Override
        public String getSubjectId() {
<span class="fc" id="L512">            return subjectId;</span>
        }
    
        /**
        * {@inheritDoc}
        */
        @Override
        public double getPercentIdentity() {
<span class="fc" id="L520">            return percentIdentity;</span>
        }
    
        /**
        * {@inheritDoc}
        */
        @Override
        public int getAlignmentLength() {
<span class="fc" id="L528">            return alignmentLength;</span>
        }
    
        /**
        * {@inheritDoc}
        */
        @Override
        public int getNumberOfMismatches() {
<span class="fc" id="L536">            return numMismatches;</span>
        }
    
        /**
        * {@inheritDoc}
        */
        @Override
        public int getNumberOfGapOpenings() {
<span class="fc" id="L544">            return numGapsOpenings;</span>
        }
    
        /**
        * {@inheritDoc}
        */
        @Override
        public DirectedRange getQueryRange() {
<span class="fc" id="L552">            return queryRange;</span>
        }
    
        /**
        * {@inheritDoc}
        */
        @Override
        public DirectedRange getSubjectRange() {
<span class="fc" id="L560">            return subjectRange;</span>
        }
    
        /**
        * {@inheritDoc}
        */
        @Override
        public BigDecimal getEvalue() {
<span class="fc" id="L568">            return eValue;</span>
        }
    
        /**
        * {@inheritDoc}
        */
        @Override
        public BigDecimal getBitScore() {
<span class="fc" id="L576">            return bitScore;</span>
        }
    
        
        
        
        /**
        * {@inheritDoc}
        */
        @Override
        public int hashCode() {
<span class="fc" id="L587">            final int prime = 31;</span>
<span class="fc" id="L588">            int result = 1;</span>
<span class="fc" id="L589">            result = prime * result + alignmentLength;</span>
<span class="pc bpc" id="L590" title="1 of 2 branches missed.">            result = prime * result</span>
<span class="fc" id="L591">                    + ((bitScore == null) ? 0 : bitScore.hashCode());</span>
<span class="pc bpc" id="L592" title="1 of 2 branches missed.">            result = prime * result</span>
<span class="fc" id="L593">                    + ((eValue == null) ? 0 : eValue.hashCode());</span>
<span class="fc" id="L594">            result = prime * result + numGapsOpenings;</span>
<span class="fc" id="L595">            result = prime * result + numMismatches;</span>
            long temp;
<span class="fc" id="L597">            temp = Double.doubleToLongBits(percentIdentity);</span>
<span class="fc" id="L598">            result = prime * result + (int) (temp ^ (temp &gt;&gt;&gt; 32));</span>
<span class="pc bpc" id="L599" title="1 of 2 branches missed.">            result = prime</span>
                    * result
<span class="pc" id="L601">                    + ((queryAlignment == null) ? 0 : queryAlignment.hashCode());</span>
<span class="pc bpc" id="L602" title="1 of 2 branches missed.">            result = prime * result</span>
<span class="fc" id="L603">                    + ((queryId == null) ? 0 : queryId.hashCode());</span>
<span class="pc bpc" id="L604" title="1 of 2 branches missed.">            result = prime * result</span>
<span class="fc" id="L605">                    + ((queryRange == null) ? 0 : queryRange.hashCode());</span>
<span class="pc bpc" id="L606" title="1 of 2 branches missed.">            result = prime</span>
                    * result
                    + ((subjectAlignment == null) ? 0 : subjectAlignment
<span class="pc" id="L609">                            .hashCode());</span>
<span class="pc bpc" id="L610" title="1 of 2 branches missed.">            result = prime * result</span>
<span class="fc" id="L611">                    + ((subjectId == null) ? 0 : subjectId.hashCode());</span>
<span class="pc bpc" id="L612" title="1 of 2 branches missed.">            result = prime * result</span>
<span class="fc" id="L613">                    + ((subjectRange == null) ? 0 : subjectRange.hashCode());</span>
<span class="fc" id="L614">            return result;</span>
        }
        /**
        * {@inheritDoc}
        */
        @Override
        public boolean equals(Object obj) {
<span class="fc bfc" id="L621" title="All 2 branches covered.">            if (this == obj) {</span>
<span class="fc" id="L622">                return true;</span>
            }
<span class="fc bfc" id="L624" title="All 2 branches covered.">            if (obj == null) {</span>
<span class="fc" id="L625">                return false;</span>
            }
<span class="fc bfc" id="L627" title="All 2 branches covered.">            if (!(obj instanceof HspImpl)) {</span>
<span class="fc" id="L628">                return false;</span>
            }
<span class="fc" id="L630">            HspImpl other = (HspImpl) obj;</span>
<span class="fc bfc" id="L631" title="All 2 branches covered.">            if (alignmentLength != other.alignmentLength) {</span>
<span class="fc" id="L632">                return false;</span>
            }
<span class="pc bpc" id="L634" title="1 of 2 branches missed.">            if (bitScore == null) {</span>
<span class="nc bnc" id="L635" title="All 2 branches missed.">                if (other.bitScore != null) {</span>
<span class="nc" id="L636">                    return false;</span>
                }
<span class="fc bfc" id="L638" title="All 2 branches covered.">            } else if (!bitScore.equals(other.bitScore)) {</span>
<span class="fc" id="L639">                return false;</span>
            }
<span class="pc bpc" id="L641" title="1 of 2 branches missed.">            if (eValue == null) {</span>
<span class="nc bnc" id="L642" title="All 2 branches missed.">                if (other.eValue != null) {</span>
<span class="nc" id="L643">                    return false;</span>
                }
<span class="fc bfc" id="L645" title="All 2 branches covered.">            } else if (!eValue.equals(other.eValue)) {</span>
<span class="fc" id="L646">                return false;</span>
            }
<span class="fc bfc" id="L648" title="All 2 branches covered.">            if (numGapsOpenings != other.numGapsOpenings) {</span>
<span class="fc" id="L649">                return false;</span>
            }
<span class="fc bfc" id="L651" title="All 2 branches covered.">            if (numMismatches != other.numMismatches) {</span>
<span class="fc" id="L652">                return false;</span>
            }
<span class="fc" id="L654">            if (Double.doubleToLongBits(percentIdentity) != Double</span>
<span class="fc bfc" id="L655" title="All 2 branches covered.">                    .doubleToLongBits(other.percentIdentity)) {</span>
<span class="fc" id="L656">                return false;</span>
            }
<span class="pc bpc" id="L658" title="1 of 2 branches missed.">            if (queryAlignment == null) {</span>
<span class="pc bpc" id="L659" title="1 of 2 branches missed.">                if (other.queryAlignment != null) {</span>
<span class="nc" id="L660">                    return false;</span>
                }
<span class="nc bnc" id="L662" title="All 2 branches missed.">            } else if (!queryAlignment.equals(other.queryAlignment)) {</span>
<span class="nc" id="L663">                return false;</span>
            }
<span class="pc bpc" id="L665" title="1 of 2 branches missed.">            if (queryId == null) {</span>
<span class="nc bnc" id="L666" title="All 2 branches missed.">                if (other.queryId != null) {</span>
<span class="nc" id="L667">                    return false;</span>
                }
<span class="fc bfc" id="L669" title="All 2 branches covered.">            } else if (!queryId.equals(other.queryId)) {</span>
<span class="fc" id="L670">                return false;</span>
            }
<span class="pc bpc" id="L672" title="1 of 2 branches missed.">            if (queryRange == null) {</span>
<span class="nc bnc" id="L673" title="All 2 branches missed.">                if (other.queryRange != null) {</span>
<span class="nc" id="L674">                    return false;</span>
                }
<span class="fc bfc" id="L676" title="All 2 branches covered.">            } else if (!queryRange.equals(other.queryRange)) {</span>
<span class="fc" id="L677">                return false;</span>
            }
<span class="pc bpc" id="L679" title="1 of 2 branches missed.">            if (subjectAlignment == null) {</span>
<span class="pc bpc" id="L680" title="1 of 2 branches missed.">                if (other.subjectAlignment != null) {</span>
<span class="nc" id="L681">                    return false;</span>
                }
<span class="nc bnc" id="L683" title="All 2 branches missed.">            } else if (!subjectAlignment.equals(other.subjectAlignment)) {</span>
<span class="nc" id="L684">                return false;</span>
            }
<span class="pc bpc" id="L686" title="1 of 2 branches missed.">            if (subjectId == null) {</span>
<span class="nc bnc" id="L687" title="All 2 branches missed.">                if (other.subjectId != null) {</span>
<span class="nc" id="L688">                    return false;</span>
                }
<span class="fc bfc" id="L690" title="All 2 branches covered.">            } else if (!subjectId.equals(other.subjectId)) {</span>
<span class="fc" id="L691">                return false;</span>
            }
<span class="pc bpc" id="L693" title="1 of 2 branches missed.">            if (subjectRange == null) {</span>
<span class="nc bnc" id="L694" title="All 2 branches missed.">                if (other.subjectRange != null) {</span>
<span class="nc" id="L695">                    return false;</span>
                }
<span class="fc bfc" id="L697" title="All 2 branches covered.">            } else if (!subjectRange.equals(other.subjectRange)) {</span>
<span class="fc" id="L698">                return false;</span>
            }
<span class="fc" id="L700">            return true;</span>
        }
    }



	
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>